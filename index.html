<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HorseOS</title>
    <style>
        @font-face {
            font-family: 'MS Sans Serif';
            src: local('MS Sans Serif'), local('Tahoma'), local('Arial');
        }
        
        :root {
            --win-teal: #008080;
            --win-gray: #c0c0c0;
            --win-dark: #808080;
            --win-light: #ffffff;
            --win-black: #000000;
            --win-blue: #000080;
            --win-navy: #0a246a;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: "MS Sans Serif", Tahoma, sans-serif;
            font-size: 11px;
            background: var(--win-teal);
            overflow: hidden;
            height: 100vh;
            cursor: default;
        }
        
        /* Desktop with pattern */
        .desktop {
            width: 100vw;
            height: 100vh;
            background: var(--win-teal);
            position: relative;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0,0,0,0.1) 0%, transparent 50%);
        }
        
        /* Desktop Icons - Authentic Windows 98 */
        .desktop-icons {
            position: absolute;
            top: 10px;
            left: 10px;
            display: flex;
            flex-direction: column;
            gap: 25px;
            z-index: 1;
        }
        
        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 75px;
            cursor: pointer;
            padding: 4px;
            border: 1px solid transparent;
        }
        
        .desktop-icon:hover {
            border: 1px dotted white;
        }
        
        .desktop-icon.selected,
        .desktop-icon:active {
            border: 1px dotted white;
            background: rgba(0,0,128,0.3);
        }
        
        .desktop-icon.selected .icon-label,
        .desktop-icon:active .icon-label {
            background: var(--win-blue);
            color: white;
        }
        
        .icon-img {
            font-size: 32px;
            margin-bottom: 4px;
            filter: drop-shadow(2px 2px 0 rgba(0,0,0,0.3));
        }
        
        .icon-label {
            text-align: center;
            color: white;
            font-size: 11px;
            text-shadow: 1px 1px 2px #000;
            padding: 1px 4px;
            background: transparent;
        }
        
        /* Windows 98 Window */
        .window {
            position: absolute;
            background: var(--win-gray);
            border: 2px solid;
            border-color: var(--win-light) var(--win-black) var(--win-black) var(--win-light);
            box-shadow: 2px 2px 0 rgba(0,0,0,0.3);
            min-width: 200px;
            display: none;
        }
        
        .window.active {
            display: block;
        }
        
        .window-title {
            background: linear-gradient(90deg, var(--win-navy), #a6caf0);
            color: white;
            padding: 2px 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            font-size: 11px;
            letter-spacing: 0.5px;
        }
        
        .window-title.inactive {
            background: linear-gradient(90deg, #808080, #c0c0c0);
        }
        
        .window-buttons {
            display: flex;
            gap: 2px;
        }
        
        .win-btn {
            width: 16px;
            height: 14px;
            background: var(--win-gray);
            border: 1px solid;
            border-color: var(--win-light) var(--win-black) var(--win-black) var(--win-light);
            font-size: 9px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: "Marlett", sans-serif;
        }
        
        .win-btn:active {
            border-color: var(--win-black) var(--win-light) var(--win-light) var(--win-black);
        }
        
        .win-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .window-content {
            padding: 8px;
            background: var(--win-gray);
        }
        
        .window-menu {
            display: flex;
            gap: 15px;
            padding: 2px 8px;
            border-bottom: 1px solid var(--win-dark);
            margin-bottom: 4px;
        }
        
        .window-menu span {
            cursor: pointer;
            padding: 2px 4px;
        }
        
        .window-menu span:hover {
            background: var(--win-blue);
            color: white;
        }
        
        .window-status {
            border-top: 1px solid var(--win-dark);
            border-bottom: 1px solid var(--win-light);
            padding: 2px 4px;
            margin-top: 4px;
            font-size: 11px;
        }
        
        /* Horse Moment - MODAL */
        .horse-modal {
            position: fixed !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%);
            width: 450px;
            z-index: 9999;
            display: none;
        }
        
        .horse-modal .window-title {
            background: linear-gradient(90deg, #800000, #ff4444);
        }
        
        /* Blocker overlay - prevents clicking anything else */
        .horse-blocker {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 9998;
            display: none;
        }
        
        .horse-blocker.active {
            display: block;
        }
        
        /* Mouse leave popup */
        .horse-leave-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #ffffcc;
            border: 3px solid #cc0000;
            padding: 20px;
            z-index: 10000;
            display: none;
            text-align: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            max-width: 300px;
        }
        
        .horse-leave-popup.show {
            display: block;
            animation: horseShake 0.5s ease-in-out;
        }
        
        @keyframes horseShake {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-50%, -50%) rotate(-5deg); }
            75% { transform: translate(-50%, -50%) rotate(5deg); }
        }
        
        .horse-leave-popup .leave-emoji {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .horse-leave-popup .leave-text {
            font-size: 14px;
            font-weight: bold;
            color: #cc0000;
            margin-bottom: 15px;
        }
        
        .horse-leave-popup button {
            padding: 8px 20px;
            background: #c0c0c0;
            border: 2px solid;
            border-color: #fff #000 #000 #fff;
            cursor: pointer;
            font-family: "MS Sans Serif", sans-serif;
        }
        
        /* README wiggle animation for first-time tutorial */
        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }
        
        .readme-wiggle {
            animation: wiggle 0.5s ease-in-out infinite;
            border: 2px dotted yellow !important;
            background: rgba(255,255,0,0.3) !important;
        }
        
        .readme-wiggle .icon-img {
            animation: wiggle 0.5s ease-in-out infinite;
            font-size: 40px !important;
        }
        
        /* First-time overlay blocker */
        .tutorial-blocker {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: transparent;
            z-index: 9990;
            display: none;
        }
        
        .tutorial-blocker.active {
            display: block;
        }
        
        /* Notification pointing to README */
        .readme-notification {
            position: absolute;
            top: 40px;
            left: 85px;
            background: #ffffcc;
            border: 2px solid #cc0000;
            padding: 8px 12px;
            font-size: 11px;
            font-weight: bold;
            z-index: 9995;
            display: none;
            box-shadow: 3px 3px 0 rgba(0,0,0,0.3);
            white-space: nowrap;
        }
        
        .readme-notification::before {
            content: "";
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            border: 5px solid transparent;
            border-right-color: #cc0000;
        }
        
        .readme-notification.show {
            display: block;
            animation: pulse 1s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .horse-content {
            text-align: center;
            padding: 20px;
        }
        
        .horse-ascii {
            font-family: "Courier New", monospace;
            font-size: 10px;
            line-height: 1.1;
            color: #5D4037;
            margin: 15px 0;
            white-space: pre;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.1);
            background: #f5f5f5;
            padding: 10px;
            border: 1px inset #c0c0c0;
            display: inline-block;
            text-align: left;
        }
        
        .horse-message {
            font-size: 13px;
            margin: 15px 0;
            line-height: 1.5;
        }
        
        .horse-message .warning {
            color: #cc0000;
            font-weight: bold;
            background: #ffffcc;
            padding: 4px 8px;
            display: inline-block;
            margin-top: 10px;
            border: 1px solid #cc0000;
        }
        
        .horse-timer {
            font-size: 28px;
            font-weight: bold;
            color: var(--win-blue);
            margin: 20px 0;
            font-family: "Courier New", monospace;
            background: #000;
            color: #0f0;
            padding: 10px 20px;
            display: inline-block;
            border: 2px inset var(--win-gray);
        }
        
        .horse-timer.complete {
            color: #0f0;
            background: #004400;
        }
        
        .progress-bar {
            width: 80%;
            height: 20px;
            background: var(--win-dark);
            border: 2px inset var(--win-gray);
            margin: 15px auto;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #000080, #1084d0, #00ff00);
            width: 100%;
            transition: width 1s linear;
        }
        
        .btn-98 {
            padding: 6px 20px;
            background: var(--win-gray);
            border: 2px solid;
            border-color: var(--win-light) var(--win-black) var(--win-black) var(--win-light);
            font-size: 11px;
            cursor: pointer;
            margin: 5px;
            font-family: "MS Sans Serif", sans-serif;
        }
        
        .btn-98:active {
            border-color: var(--win-black) var(--win-light) var(--win-light) var(--win-black);
        }
        
        .btn-98:disabled {
            color: var(--win-dark);
            cursor: not-allowed;
        }
        
        .btn-98.primary {
            background: #000080;
            color: white;
            border-color: #4444ff #000044 #000044 #4444ff;
        }
        
        /* Calculator */
        .calc-window { width: 220px; top: 100px; left: 150px; }
        .calc-display {
            background: white;
            border: 2px inset var(--win-gray);
            padding: 8px;
            font-size: 20px;
            text-align: right;
            margin-bottom: 8px;
            font-family: "Courier New", monospace;
            min-height: 36px;
            overflow: hidden;
        }
        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 3px;
        }
        .calc-buttons button {
            padding: 8px;
            font-size: 14px;
            background: var(--win-gray);
            border: 2px solid;
            border-color: var(--win-light) var(--win-black) var(--win-black) var(--win-light);
            cursor: pointer;
            font-family: "MS Sans Serif", sans-serif;
        }
        .calc-buttons button:active {
            border-color: var(--win-black) var(--win-light) var(--win-light) var(--win-black);
        }
        .calc-buttons .equals {
            grid-row: span 2;
            background: #ff6b6b;
        }
        .calc-buttons .zero { grid-column: span 2; }
        
        /* Minesweeper */
        .mine-window { width: 220px; top: 150px; left: 200px; }
        .mine-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px;
            border: 2px inset var(--win-gray);
            margin-bottom: 8px;
            background: var(--win-gray);
        }
        .mine-counter {
            background: black;
            color: red;
            font-family: "Courier New", monospace;
            font-size: 18px;
            padding: 2px 6px;
            border: 1px inset var(--win-gray);
        }
        .mine-btn {
            font-size: 16px;
            padding: 2px 8px;
        }
        .mine-grid {
            display: grid;
            grid-template-columns: repeat(8, 20px);
            gap: 1px;
            background: var(--win-dark);
            border: 3px inset var(--win-gray);
            padding: 3px;
            width: fit-content;
            margin: 0 auto;
        }
        .mine-cell {
            width: 20px;
            height: 20px;
            background: var(--win-gray);
            border: 2px solid;
            border-color: var(--win-light) var(--win-black) var(--win-black) var(--win-light);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        .mine-cell:active, .mine-cell.revealed {
            border: 1px solid var(--win-dark);
            background: #c0c0c0;
        }
        .mine-cell.mine { background: red; }
        .mine-cell.flagged::after { content: "üö©"; font-size: 10px; }
        .mine-cell.num-1 { color: blue; }
        .mine-cell.num-2 { color: green; }
        .mine-cell.num-3 { color: red; }
        
        /* Explorer Window */
        .explorer-window { width: 350px; top: 80px; left: 100px; }
        .explorer-content {
            background: white;
            border: 2px inset var(--win-gray);
            min-height: 200px;
            padding: 4px;
        }
        .folder-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px;
            cursor: pointer;
        }
        .folder-item:hover {
            background: #000080;
            color: white;
        }
        .folder-icon { font-size: 20px; }
        
        /* Taskbar */
        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 28px;
            background: var(--win-gray);
            border-top: 2px solid var(--win-light);
            display: flex;
            align-items: center;
            padding: 2px;
            z-index: 1000;
        }
        
        .start-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 2px 6px;
            background: var(--win-gray);
            border: 2px solid;
            border-color: var(--win-light) var(--win-black) var(--win-black) var(--win-light);
            font-weight: bold;
            font-size: 11px;
            cursor: pointer;
            font-family: "MS Sans Serif", sans-serif;
        }
        
        .start-btn:active, .start-btn.active {
            border-color: var(--win-black) var(--win-light) var(--win-light) var(--win-black);
        }
        
        .start-btn img, .start-btn span { font-size: 16px; }
        
        .taskbar-divider {
            width: 2px;
            height: 22px;
            border-left: 1px solid var(--win-dark);
            border-right: 1px solid var(--win-light);
            margin: 0 4px;
        }
        
        .taskbar-items {
            flex: 1;
            display: flex;
            gap: 2px;
            padding: 0 4px;
        }
        
        .taskbar-item {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            background: var(--win-gray);
            border: 2px solid;
            border-color: var(--win-light) var(--win-dark) var(--win-dark) var(--win-light);
            font-size: 11px;
            cursor: pointer;
            max-width: 160px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .taskbar-item.active {
            border-color: var(--win-dark) var(--win-light) var(--win-light) var(--win-dark);
            background: #d4d0c8;
        }
        
        .clock {
            margin-left: auto;
            padding: 2px 8px;
            border: 2px inset var(--win-gray);
            font-size: 11px;
            min-width: 60px;
            text-align: center;
            font-family: "Courier New", monospace;
            background: #c0c0c0;
        }
        
        /* Start Menu */
        .start-menu {
            position: fixed;
            bottom: 28px;
            left: 0;
            width: 200px;
            background: var(--win-gray);
            border: 2px solid;
            border-color: var(--win-light) var(--win-black) var(--win-black) var(--win-light);
            z-index: 1001;
            display: none;
        }
        
        .start-header {
            background: linear-gradient(90deg, var(--win-navy), #a6caf0);
            padding: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .start-user-icon {
            font-size: 32px;
            border: 2px solid var(--win-light);
            border-radius: 4px;
            padding: 2px;
            background: var(--win-gray);
        }
        
        .start-username {
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .start-items { padding: 4px; }
        
        .start-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 8px;
            cursor: pointer;
        }
        
        .start-item:hover {
            background: var(--win-blue);
            color: white;
        }
        
        .start-item span { font-size: 16px; }
        
        .start-separator {
            height: 2px;
            border-top: 1px solid var(--win-dark);
            border-bottom: 1px solid var(--win-light);
            margin: 4px 0;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #ffffcc;
            border: 2px solid #cc0000;
            padding: 10px;
            z-index: 9999;
            display: none;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.3);
        }
        
        .notification.show { display: block; }
        
        @media (max-width: 600px) {
            .horse-modal { width: 95vw; }
            .desktop-icons { top: 5px; left: 5px; }
            .desktop-icon { width: 60px; }
            .icon-img { font-size: 24px; }
        }
    </style>
</head>
<body>
    <div class="desktop" id="desktop">
        <!-- Desktop Icons -->
        <div class="desktop-icons">
            <div class="desktop-icon" onclick="openWindow('welcome')">
                <div class="icon-img">üìñ</div>
                <div class="icon-label">README.txt</div>
            </div>
            <div class="desktop-icon" onclick="openWindow('scheduler')">
                <div class="icon-img">‚è∞</div>
                <div class="icon-label">Scheduler</div>
            </div>
            <div class="desktop-icon" onclick="openHorse()">
                <div class="icon-img">üêé</div>
                <div class="icon-label">Horse Moment</div>
            </div>
            <div class="desktop-icon" onclick="openWindow('explorer')">
                <div class="icon-img">üíª</div>
                <div class="icon-label">My Computer</div>
            </div>
            <div class="desktop-icon" onclick="openWindow('calc')">
                <div class="icon-img">üßÆ</div>
                <div class="icon-label">Calculator</div>
            </div>
            <div class="desktop-icon" onclick="openWindow('minesweeper'); initMine()">
                <div class="icon-img">üí£</div>
                <div class="icon-label">Minesweeper</div>
            </div>
            <div class="desktop-icon" onclick="showNotification('üê¥ Horse Fact: Horses can sleep standing up!')">
                <div class="icon-img">üìù</div>
                <div class="icon-label">Horse Facts</div>
            </div>
            <div class="desktop-icon" onclick="openWindow('recycle')">
                <div class="icon-img">üóëÔ∏è</div>
                <div class="icon-label">Recycle Bin</div>
            </div>
        </div>

        <!-- Horse Moment Modal -->
        <div class="window horse-modal" id="horseModal">
            <div class="window-title">
                <span>‚ö†Ô∏è Scheduled_Horse_Moment.exe</span>
                <div class="window-buttons">
                    <button class="win-btn" disabled>√ó</button>
                </div>
            </div>
            <div class="window-content horse-content">
                <div class="horse-ascii">
‚†Ä‚¢±‚†ê‚†Ñ‚†ô‚†Ω‚°≤‚£§‚°Ä‚†Ä‚†Ä‚†Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚°æ‚†É‚†Ä‚†Ä‚¢Ä‚†à‚†ª‚£ø‚£ø‚£∂‚°∂‚¢É‚£ß‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚°º‚£ß‚£Ä‚£†‚°¥‚†Ä‚¢Ç‚†Ä‚†ô‚£ø‚£ø‚£ø‚£ø‚£ø‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚¢∏‚£Ö‚£©‚†ü‚†Å‚¢∞‚†Ä‚†∏‚°Ñ‚†Ä‚†ê‚¢ª‚£ø‚£ø‚°ø‚†Ç‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†à‚†ô‚†Å‚†Ä‚†Ä‚¢Ä‚†Ä‚†Ä‚°á‚†Ä‚†Ä‚†Ñ‚†ª‚†ø‚¢∑‚£ã‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£∏‚†Ä‚¢†‚†á‚¢Ä‚°ú‚†Ä‚†Ä‚†ê‚°Ñ‚†Ä‚†Ä‚†à‚†à‚†ê‚¢§‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚°è‚†Ä‚¢à‚°¥‚†ã‚†Ä‚†Ä‚†Ä‚†Ä‚°ó‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢ª‚£ø‚£∂‚£¶‚£Ñ‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚°æ‚†Ä‚°Ñ‚°é‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚°∞‚†É‚†Ä‚†Ä‚†Ä‚†Ä‚°†‚†Ä‚¢Ä‚°á‚†ô‚£ø‚£ø‚°∑
‚†Ä‚†Ä‚†Ä‚†Ä‚°†‚†£‚†Ä‚†á‚°Ñ‚†Ä‚†Ä‚†Ä‚¢†‚†î‚†Å‚†Ä‚†Ä‚†Ä‚£†‚†û‚†Ä‚¢Ä‚°ú‚£†‚£æ‚¢ø‚†ü‚†Ä
‚†Ä‚†Ä‚¢Ä‚°¥‚†Å‚£Ä‚†§‚†ä‚†ò‚°Ü‚†Ä‚£†‚†£‚¢§‚†§‚†¥‚¢≤‚†ã‚†ô‚†Ä‚£∞‚†ã‚†ò‚°ù‚†Å‚†ò‚†Ñ‚†Ä
‚†Ä‚£∞‚°ø‚†ñ‚†â‚†Ä‚†Ä‚¢Ä‚†ä‚°Ä‚†ö‚†Å‚†Ä‚†à‚†Ä‚°∞‚†Å‚†Ä‚°Ü‚°ú‚†Å‚†Ä‚†Ä‚†Å‚†Ä‚†Ä‚†Ä‚†Ä
‚¢Ä‚°ø‚†Å‚†Ä‚†Ä‚†Ä‚¢∞‚£ø‚†è‚†Ä‚†Ä‚†Ä‚†Ä‚°Ä‚¢∞‚†Å‚¢Ä‚£º‚°û‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚£æ‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢ª‚£ß‚£∂‚°Ñ‚†Ä‚†Ä‚£á‚†é‚£†‚°æ‚†õ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚£ø‚£∑‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚†â‚†Å‚†Ä‚£º‚¢è‚£¥‚†ü‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†ô‚†ã‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£º‚£ø‚£æ‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚£æ‚†è‚†Ä‚†â‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
                </div>
                <div class="horse-message">
                    <p><strong>Please stand by for a scheduled Horse Moment.</strong></p>
                    <p>You will now contemplate and reflect.</p>
                    <p style="color:#800000;font-weight:bold">This is a time of seriousness.</p>
                    <p class="warning">‚ö†Ô∏è You cannot change this in settings.</p>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="horseProgress"></div>
                </div>
                <div class="horse-timer" id="horseTimer">60</div>
                <div>
                    <button class="btn-98 primary" id="horseBtn" onclick="startHorse()">I am Contemplating</button>
                </div>
            </div>
        </div>

        <!-- My Computer Window -->
        <div class="window explorer-window" id="explorer">
            <div class="window-title">
                <span>üíª My Computer</span>
                <div class="window-buttons">
                    <button class="win-btn">_</button>
                    <button class="win-btn">‚ñ°</button>
                    <button class="win-btn" onclick="closeWindow('explorer')">√ó</button>
                </div>
            </div>
            <div class="window-menu">
                <span>File</span><span>Edit</span><span>View</span><span>Help</span>
            </div>
            <div class="window-content explorer-content">
                <div class="folder-item" onclick="openWindow('floppyMystery')" style="cursor:pointer"><span class="folder-icon">üíæ</span><span>3¬Ω Floppy (A:)</span></div>
                <div class="folder-item" onclick="openWindow('driveMystery')" style="cursor:pointer"><span class="folder-icon">üíø</span><span>Local Disk (C:)</span></div>
                <div class="folder-item" onclick="openWindow('controlMystery')" style="cursor:pointer"><span class="folder-icon">üåê</span><span>Control Panel</span></div>
                <div class="folder-item" onclick="openHorse()" style="cursor:pointer"><span class="folder-icon">üêé</span><span>HorseOS System</span></div>
            </div>
            <div class="window-status">4 object(s)</div>
        </div>

        <!-- Calculator Window -->
        <div class="window calc-window" id="calc">
            <div class="window-title">
                <span>üßÆ Calculator</span>
                <div class="window-buttons">
                    <button class="win-btn">_</button>
                    <button class="win-btn">‚ñ°</button>
                    <button class="win-btn" onclick="closeWindow('calc')">√ó</button>
                </div>
            </div>
            <div class="window-content">
                <div class="calc-display" id="calcDisplay">0</div>
                <div class="calc-buttons">
                    <button onclick="calc('C')">C</button>
                    <button onclick="calc('CE')">CE</button>
                    <button onclick="calc('‚å´')">‚å´</button>
                    <button onclick="calc('/')">/</button>
                    <button onclick="calc('7')">7</button>
                    <button onclick="calc('8')">8</button>
                    <button onclick="calc('9')">9</button>
                    <button onclick="calc('*')">√ó</button>
                    <button onclick="calc('4')">4</button>
                    <button onclick="calc('5')">5</button>
                    <button onclick="calc('6')">6</button>
                    <button onclick="calc('-')">-</button>
                    <button onclick="calc('1')">1</button>
                    <button onclick="calc('2')">2</button>
                    <button onclick="calc('3')">3</button>
                    <button onclick="calc('+')">+</button>
                    <button onclick="calc('0')" class="zero">0</button>
                    <button onclick="calc('.')">.</button>
                    <button onclick="calc('=')" class="equals">=</button>
                </div>
            </div>
        </div>

        <!-- Minesweeper Window -->
        <div class="window mine-window" id="minesweeper">
            <div class="window-title">
                <span>üí£ Minesweeper</span>
                <div class="window-buttons">
                    <button class="win-btn">_</button>
                    <button class="win-btn">‚ñ°</button>
                    <button class="win-btn" onclick="closeWindow('minesweeper')">√ó</button>
                </div>
            </div>
            <div class="window-content">
                <div class="mine-header">
                    <div class="mine-counter" id="mineCount">010</div>
                    <button class="btn-98 mine-btn" onclick="initMine()">üòä</button>
                    <div class="mine-counter" id="mineTime">000</div>
                </div>
                <div class="mine-grid" id="mineGrid"></div>
            </div>
        </div>

        <!-- Welcome/ReadMe Window -->
        <div class="window" id="welcome" style="width:450px;top:50px;left:50px;z-index:10000">
            <div class="window-title">
                <span>üìñ README.txt - HorseOS</span>
                <div class="window-buttons">
                    <button class="win-btn">_</button>
                    <button class="win-btn">‚ñ°</button>
                    <button class="win-btn" onclick="closeWindow('welcome')">√ó</button>
                </div>
            </div>
            <div class="window-menu">
                <span>File</span><span>Edit</span><span>Search</span><span>Help</span>
            </div>
            <div class="window-content" style="background:#fff;padding:15px;font-family:'Courier New',monospace;font-size:12px;line-height:1.6;max-height:400px;overflow-y:auto">
                <pre style="white-space:pre-wrap;font-family:inherit">
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                    üê¥ WELCOME TO HORSEOS üê¥                  ‚ïë
‚ïë              "The Operating System You Can't Ignore"          ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

WHAT IS THIS?
-------------
HorseOS is a digital wellness platform designed to force you to take 
breaks using the power of ABSURDITY and HORSES.

THE SCIENCE (we made it up):
---------------------------
Studies show* that humans need mandatory contemplation breaks every 
20 minutes. But regular wellness apps are BORING and you ignore them.

*Studies conducted by horses

HOW IT WORKS:
-------------
1. HorseOS INTERRUPTS your doomscrolling
2. You CANNOT close the window (seriously, we disabled it)
3. You MUST contemplate for 60 seconds
4. The horse judges you silently
5. You return to your life, slightly more equine

FEATURES:
---------
üê¥ SCHEDULED HORSE MOMENTS
   - Uncloseable 60-second contemplation sessions
   - Random existential prompts
   - Progress bar for your suffering
   
üí£ MINESWEEPER
   - Because you need something to do while avoiding work
   - 10 mines, infinite regrets
   
üßÆ CALCULATOR
   - For calculating how much time you've wasted
   
üóëÔ∏è RECYCLE BIN
   - Delete your screen time guilt
   - (It comes back, guilt always does)

FAQ:
----
Q: Can I turn off Horse Moments?
A: No. The settings button is decorative.

Q: Why a horse?
A: Horses are nature's most contemplative creatures. 
   Also, we had the domain name.

Q: Is this malware?
A: Only if you consider self-care malicious.

Q: My boss caught me doing a Horse Moment at work.
A: Tell them you're "optimizing cognitive performance through 
   structured contemplation intervals." They'll be impressed.

CONTROLS:
---------
‚Ä¢ Click icons to open apps
‚Ä¢ Drag windows by title bar
‚Ä¢ Right-click Minesweeper cells to flag
‚Ä¢ Press any key during startup to skip (but why would you?)

REMEMBER:
---------
"The horse is always watching."
"Contemplation is mandatory."
"This is not a suggestion."

- HorseOS Development Team (just a horse with a keyboard)

P.S. - If you read this far, you definitely need a Horse Moment.
                </pre>
            </div>
            <div class="window-status">Readme.txt - 4,847 bytes</div>
        </div>

        <!-- Horse Scheduler Window -->
        <div class="window" id="scheduler" style="width:350px;top:100px;left:400px">
            <div class="window-title">
                <span>‚è∞ Horse Moment Scheduler</span>
                <div class="window-buttons">
                    <button class="win-btn">_</button>
                    <button class="win-btn">‚ñ°</button>
                    <button class="win-btn" onclick="closeWindow('scheduler')">√ó</button>
                </div>
            </div>
            <div class="window-content" style="padding:15px">
                <div style="text-align:center;margin-bottom:15px">
                    <div style="font-size:40px;margin-bottom:10px">üê¥ ‚è∞</div>
                    <h3 style="margin-bottom:5px">Schedule Your Destiny</h3>
                    <p style="color:#666;font-size:10px">(The horse appreciates planning)</p>
                </div>
                
                <div style="background:#ffffcc;border:1px solid #cc0;padding:10px;margin-bottom:15px">
                    <strong>Current Settings:</strong><br>
                    Auto-Horse: <span id="autoStatus" style="color:red">OFF</span><br>
                    Interval: <span id="intervalDisplay">Manual</span><br>
                    Duration: <span id="durationDisplay">60 seconds</span>
                </div>
                
                <div style="margin-bottom:15px">
                    <label style="display:block;margin-bottom:5px;font-weight:bold">‚è±Ô∏è Horse Moment Duration:</label>
                    <select id="durationSelect" class="btn-98" style="width:100%;padding:5px" onchange="updateDuration()">
                        <option value="30">30 seconds (Casual)</option>
                        <option value="60" selected>60 seconds (Standard)</option>
                        <option value="120">2 minutes (Serious)</option>
                        <option value="300">5 minutes (Existential Crisis)</option>
                        <option value="600">10 minutes (Horse Master)</option>
                    </select>
                </div>
                
                <div style="margin-bottom:15px">
                    <label style="display:block;margin-bottom:5px;font-weight:bold">üîÑ Auto-Horse Interval:</label>
                    <select id="intervalSelect" class="btn-98" style="width:100%;padding:5px" onchange="updateInterval()">
                        <option value="0" selected>Manual Only (When you click)</option>
                        <option value="5">Every 5 minutes</option>
                        <option value="15">Every 15 minutes</option>
                        <option value="20">Every 20 minutes (Recommended)</option>
                        <option value="30">Every 30 minutes</option>
                        <option value="60">Every hour</option>
                    </select>
                </div>
                
                <div style="margin-bottom:15px">
                    <label style="display:block;margin-bottom:5px;font-weight:bold">üé≠ Contemplation Style:</label>
                    <select id="styleSelect" class="btn-98" style="width:100%;padding:5px">
                        <option value="standard" selected>Standard</option>
                        <option value="existential">Existential Dread</option>
                        <option value="professional">Corporate</option>
                        <option value="zen">Zen Master</option>
                        <option value="judgmental">Judgmental</option>
                    </select>
                </div>
                
                <div style="text-align:center;margin-top:20px">
                    <button class="btn-98 primary" onclick="saveSchedule()" style="padding:8px 20px">
                        üíæ Save Settings
                    </button>
                    <button class="btn-98" onclick="testHorseNow()" style="margin-left:10px">
                        üê¥ Test Horse Moment
                    </button>
                </div>
                
                <div id="scheduleMsg" style="text-align:center;margin-top:10px;font-size:10px;color:green;min-height:15px"></div>
            </div>
        </div>

        <!-- Recycle Bin -->
        <div class="window" id="recycle" style="width:300px;top:200px;left:250px">
            <div class="window-title">
                <span>üóëÔ∏è Recycle Bin</span>
                <div class="window-buttons">
                    <button class="win-btn">_</button>
                    <button class="win-btn">‚ñ°</button>
                    <button class="win-btn" onclick="closeWindow('recycle')">√ó</button>
                </div>
            </div>
            <div class="window-content explorer-content" style="min-height:150px">
                <div class="folder-item"><span>üóëÔ∏è</span><span>Your Screen Time Guilt</span></div>
                <div class="folder-item"><span>üóëÔ∏è</span><span>Doomscrolling Addiction</span></div>
                <div class="folder-item"><span>üóëÔ∏è</span><span>Productivity Anxiety</span></div>
                <div style="text-align:center;margin-top:20px">
                    <button class="btn-98" onclick="emptyRecycle()">Empty Recycle Bin</button>
                </div>
            </div>
        </div>

        <!-- Notification -->
        <div class="notification" id="notification">
            <span id="notifText"></span>
        </div>

        <!-- Horse Blocker Overlay -->
        <div class="horse-blocker" id="horseBlocker"></div>
        
        <!-- Tutorial Blocker (for first-time experience) -->
        <div class="tutorial-blocker" id="tutorialBlocker"></div>
        
        <!-- README Notification Arrow -->
        <div class="readme-notification" id="readmeNotification">
            üëÜ Click here!
        </div>

        <!-- Mouse Leave Popup -->
        <div class="horse-leave-popup" id="horseLeavePopup">
            <div class="leave-emoji">üêé</div>
            <div class="leave-text" id="leaveText">Where do you think you're going?</div>
            <button onclick="dismissLeavePopup()">I was just stretching...</button>
        </div>

        <!-- Floppy Disk Mystery -->
        <div class="window" id="floppyMystery" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:380px;z-index:9999">
            <div class="window-title" style="background:linear-gradient(90deg,#1a237e,#3949ab)">
                <span>üíæ A:\\ - SECTOR_NOT_FOUND</span>
                <div class="window-buttons">
                    <button class="win-btn" onclick="closeWindow('floppyMystery')">√ó</button>
                </div>
            </div>
            <div class="window-content" style="text-align:center;padding:20px;background:#0d1b2a;color:#a8dadc;font-family:monospace">
                <div style="font-size:10px;line-height:1.1;margin:10px 0;white-space:pre;color:#778da9">
    ‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£Ä‚£Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚£∞‚£ø‚£ø‚£ø‚£ø‚£Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚£∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚¢†‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚£º‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ß‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£¶‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£¶‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†ô‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£¶‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†ô‚†ª‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚£Ñ‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚†õ‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚°Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†ô‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ñ
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†ô‚†ª‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†É
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚†õ‚†ø‚†ø‚†ü‚†ã‚†Ä‚†Ä
                </div>
                <p style="font-style:italic;color:#778da9;margin:15px 0;font-size:12px">"The floppy disk contains the original horse source code... from 1987."</p>
                <p style="font-size:10px;color:#415a77">General Failure reading drive A:<br>Abort, Retry, Fail?</p>
                <div style="margin-top:15px">
                    <button class="btn-98" onclick="closeWindow('floppyMystery')" style="background:#3949ab;color:#fff">Abort</button>
                    <button class="btn-98" onclick="showNotification('üê¥ The horse rejects your retry.')" style="margin:0 5px">Retry</button>
                    <button class="btn-98" onclick="showNotification('üê¥ You cannot fail the horse.')">Fail</button>
                </div>
            </div>
        </div>

        <!-- C: Drive Mystery -->
        <div class="window" id="driveMystery" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:380px;z-index:9999">
            <div class="window-title" style="background:linear-gradient(90deg,#00695c,#00897b)">
                <span>üíø C:\\ - ACCESS_DENIED</span>
                <div class="window-buttons">
                    <button class="win-btn" onclick="closeWindow('driveMystery')">√ó</button>
                </div>
            </div>
            <div class="window-content" style="text-align:center;padding:20px;background:#1b263b;color:#e0e1dd;font-family:monospace">
                <div style="font-size:10px;line-height:1.1;margin:10px 0;white-space:pre;color:#778da9">
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£§‚£∂‚£∂‚£∂‚£∂‚£§‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£¥‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£¶‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚¢Ä‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚°Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚¢Ä‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ä‚†Ä‚†Ä
    ‚†Ä‚¢Ä‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ä‚†Ä
    ‚£º‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ñ
    ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ü
    ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á
    ‚†∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ü‚†Ä
    ‚†Ä‚†π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ü‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†ã‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†à‚†ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†ã‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†ã‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚†ª‚£ø‚£ø‚£ø‚£ø‚†ü‚†â‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†õ‚†õ‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
                </div>
                <p style="font-style:italic;color:#778da9;margin:15px 0;font-size:12px">"C: Drive contains 847GB of uncompressed horse thoughts."</p>
                <p style="font-size:10px;color:#415a77">Disk is write-protected.<br>The horse protects what matters.</p>
                <div style="margin-top:15px;background:#0d1b2a;border:1px inset #415a77;padding:10px">
                    <p style="font-size:9px;color:#e0e1dd;text-align:left;margin:0">
    Volume in drive C is HORSE_OS<br>
    Volume Serial Number is NE1GH-8474<br>
    Directory of C:\\<br><br>
    &lt;DIR&gt;          .<br>
    &lt;DIR&gt;          ..<br>
    HORSE     SYS      1,337,000,000 bytes<br>
    NEIGH     EXE             42 bytes<br>
                   1 file(s)         1,337,000,042 bytes
                    </p>
                </div>
                <button class="btn-98" onclick="closeWindow('driveMystery')" style="margin-top:15px;background:#00695c;color:#fff">Eject</button>
            </div>
        </div>

        <!-- Control Panel Mystery -->
        <div class="window" id="controlMystery" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:380px;z-index:9999">
            <div class="window-title" style="background:linear-gradient(90deg,#4a148c,#7b1fa2)">
                <span>üåê Control Panel - HORSE_SETTINGS</span>
                <div class="window-buttons">
                    <button class="win-btn" onclick="closeWindow('controlMystery')">√ó</button>
                </div>
            </div>
            <div class="window-content" style="text-align:center;padding:20px;background:#2e1a47;color:#e1bee7;font-family:monospace">
                <div style="font-size:10px;line-height:1.1;margin:10px 0;white-space:pre;color:#9c27b0">
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£Ä‚£Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£¥‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£¶‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£∞‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚†Ä‚£º‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ß‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚†Ä‚¢∞‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ü‚†Ä‚†Ä‚†Ä
    ‚†Ä‚†Ä‚¢†‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ñ‚†Ä‚†Ä
    ‚†Ä‚¢Ä‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ä‚†Ä
    ‚†Ä‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á
    ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á
    ‚†ò‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†á
    ‚†Ä‚†π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ü‚†Ä
    ‚†Ä‚†Ä‚†ô‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†ã‚†Ä‚†Ä
                </div>
                <p style="font-style:italic;color:#ce93d8;margin:15px 0;font-size:12px">"The Control Panel has no settings. The horse controls all."</p>
                <div style="text-align:left;background:#1a1a2e;border:1px inset #7b1fa2;padding:10px;margin:10px 0">
                    <p style="font-size:10px;color:#e1bee7;margin:0">
    ‚òë Horse Moments: [ALWAYS ON]<br>
    ‚òë Judgment: [ENABLED]<br>
    ‚òë Existential Dread: [MAXIMUM]<br>
    ‚òê Skip Option: [DISABLED]<br>
    ‚òë Soul Monitoring: [ACTIVE]
                    </p>
                </div>
                <p style="font-size:9px;color:#9c27b0">Attempting to change settings will alert the horse.</p>
                <button class="btn-98" onclick="showNotification('üê¥ The horse has denied your request.');closeWindow('controlMystery')" style="margin-top:10px;background:#7b1fa2;color:#fff">Apply Changes</button>
            </div>
        </div>

        <!-- First Time Welcome Popup -->
        <div class="horse-leave-popup" id="firstTimePopup" style="z-index:10001">
            <div class="leave-emoji">üêé</div>
            <div class="leave-text">Welcome to HorseOS!</div>
            <p style="margin:10px 0;font-size:12px">Click üìñ README.txt for more information...</p>
            <p style="margin:10px 0;font-size:11px;color:#666">(Just kidding, you can't)</p>
        </div>

        <!-- Taskbar -->
        <div class="taskbar">
            <button class="start-btn" id="startBtn" onclick="toggleStart()">
                <span>üê¥</span> Start
            </button>
            <div class="taskbar-divider"></div>
            <div class="taskbar-items">
                <div class="taskbar-item active" onclick="openHorse()">
                    <span>üê¥</span> Horse Moment
                </div>
            </div>
            <div class="clock" id="clock">--:--</div>
        </div>

        <!-- Start Menu -->
        <div class="start-menu" id="startMenu">
            <div class="start-header">
                <div class="start-user-icon">üê¥</div>
                <div class="start-username">Horse User</div>
            </div>
            <div class="start-items">
                <div class="start-item" onclick="openWindow('welcome');toggleStart()">
                    <span>üìñ</span> README.txt
                </div>
                <div class="start-item" onclick="openWindow('scheduler');toggleStart()">
                    <span>‚è∞</span> Scheduler
                </div>
                <div class="start-item" onclick="openWindow('explorer');toggleStart()">
                    <span>üíª</span> My Computer
                </div>
                <div class="start-item" onclick="openWindow('calc');toggleStart()">
                    <span>üßÆ</span> Calculator
                </div>
                <div class="start-item" onclick="openWindow('minesweeper');initMine();toggleStart()">
                    <span>üí£</span> Minesweeper
                </div>
                <div class="start-separator"></div>
                <div class="start-item" onclick="openHorse();toggleStart()">
                    <span>üê¥</span> Horse Moment
                </div>
                <div class="start-separator"></div>
                <div class="start-item" onclick="alert('üê¥ It is now safe to contemplate.')">
                    <span>‚èª</span> Shut Down...
                </div>
            </div>
        </div>
    </div>

    <script>
        // Clock
        function updateClock() {
            const now = new Date();
            const h = now.getHours() % 12 || 12;
            const m = now.getMinutes().toString().padStart(2, '0');
            const s = now.getSeconds().toString().padStart(2, '0');
            const ampm = now.getHours() >= 12 ? 'PM' : 'AM';
            document.getElementById('clock').textContent = h + ':' + m + ' ' + ampm;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // Window management
        function openWindow(id) {
            const win = document.getElementById(id);
            win.style.display = 'block';
            win.style.zIndex = getMaxZ() + 1;
        }
        
        function closeWindow(id) {
            document.getElementById(id).style.display = 'none';
        }
        
        function getMaxZ() {
            const windows = document.querySelectorAll('.window');
            let max = 10;
            windows.forEach(w => {
                const z = parseInt(w.style.zIndex) || 10;
                if (z > max) max = z;
            });
            return max;
        }

        // Start Menu
        function toggleStart() {
            const menu = document.getElementById('startMenu');
            const btn = document.getElementById('startBtn');
            const isOpen = menu.style.display === 'block';
            menu.style.display = isOpen ? 'none' : 'block';
            btn.classList.toggle('active', !isOpen);
        }
        
        document.addEventListener('click', e => {
            const menu = document.getElementById('startMenu');
            const btn = document.getElementById('startBtn');
            if (!menu.contains(e.target) && !btn.contains(e.target)) {
                menu.style.display = 'none';
                btn.classList.remove('active');
            }
        });

        // Horse Moment
        let horseTime = 60;
        let horseInterval;
        let horseRunning = false;
        
        function openHorse() {
            document.getElementById('horseModal').style.display = 'block';
            document.getElementById('horseModal').style.zIndex = 9999;
        }
        
        function startHorse() {
            if (horseRunning) return;
            horseRunning = true;
            
            const btn = document.getElementById('horseBtn');
            btn.disabled = true;
            btn.textContent = 'Contemplating...';
            
            document.getElementById('horseProgress').style.width = '100%';
            document.getElementById('horseProgress').style.transition = 'width 60s linear';
            
            horseInterval = setInterval(() => {
                horseTime--;
                document.getElementById('horseTimer').textContent = horseTime;
                
                if (horseTime <= 0) {
                    clearInterval(horseInterval);
                    document.getElementById('horseTimer').innerHTML = '‚úì DONE';
                    document.getElementById('horseTimer').classList.add('complete');
                    btn.disabled = false;
                    btn.textContent = 'Return to Desktop';
                    btn.onclick = finishHorse;
                    showNotification('üéâ Contemplation complete! You are now more horse.');
                }
            }, 1000);
        }
        
        function finishHorse() {
            document.getElementById('horseModal').style.display = 'none';
            // Reset
            horseTime = 60;
            horseRunning = false;
            document.getElementById('horseTimer').textContent = '60';
            document.getElementById('horseTimer').classList.remove('complete');
            document.getElementById('horseProgress').style.width = '100%';
            document.getElementById('horseProgress').style.transition = 'none';
            
            const btn = document.getElementById('horseBtn');
            btn.textContent = 'I am Contemplating';
            btn.onclick = startHorse;
        }

        // Calculator
        let calcVal = '0', calcPrev = null, calcOp = null, calcNew = true;
        function calc(btn) {
            if (btn >= '0' && btn <= '9') {
                if (calcNew) { calcVal = btn; calcNew = false; }
                else calcVal = calcVal === '0' ? btn : calcVal + btn;
            } else if (btn === 'C') {
                calcVal = '0'; calcPrev = null; calcOp = null; calcNew = true;
            } else if (btn === 'CE') {
                calcVal = '0'; calcNew = true;
            } else if (btn === '‚å´') {
                calcVal = calcVal.length > 1 ? calcVal.slice(0, -1) : '0';
            } else if (btn === '.') {
                if (!calcVal.includes('.')) calcVal += '.';
            } else if (btn === '=') {
                if (calcOp && calcPrev !== null) {
                    const cur = parseFloat(calcVal);
                    switch(calcOp) {
                        case '+': calcVal = String(calcPrev + cur); break;
                        case '-': calcVal = String(calcPrev - cur); break;
                        case '*': calcVal = String(calcPrev * cur); break;
                        case '/': calcVal = cur !== 0 ? String(calcPrev / cur) : 'Error'; break;
                    }
                    calcOp = null; calcPrev = null; calcNew = true;
                }
            } else {
                calcPrev = parseFloat(calcVal);
                calcOp = btn;
                calcNew = true;
            }
            document.getElementById('calcDisplay').textContent = calcVal.substring(0, 12);
        }

        // Minesweeper
        let mineGrid = [], mineRevealed = [], mineFlags = [], mineGameOver = false;
        const MINE_ROWS = 8, MINE_COLS = 8, MINE_TOTAL = 10;
        
        function initMine() {
            const grid = document.getElementById('mineGrid');
            grid.innerHTML = '';
            mineGrid = []; mineRevealed = []; mineFlags = []; mineGameOver = false;
            
            for (let r = 0; r < MINE_ROWS; r++) {
                mineGrid[r] = []; mineRevealed[r] = []; mineFlags[r] = [];
                for (let c = 0; c < MINE_COLS; c++) {
                    mineGrid[r][c] = 0; mineRevealed[r][c] = false; mineFlags[r][c] = false;
                    const cell = document.createElement('div');
                    cell.className = 'mine-cell';
                    cell.onclick = () => clickMine(r, c);
                    cell.oncontextmenu = e => { e.preventDefault(); flagMine(r, c); };
                    grid.appendChild(cell);
                }
            }
            
            let placed = 0;
            while (placed < MINE_TOTAL) {
                const r = Math.floor(Math.random() * MINE_ROWS);
                const c = Math.floor(Math.random() * MINE_COLS);
                if (mineGrid[r][c] !== -1) { mineGrid[r][c] = -1; placed++; }
            }
            
            for (let r = 0; r < MINE_ROWS; r++)
                for (let c = 0; c < MINE_COLS; c++)
                    if (mineGrid[r][c] !== -1)
                        mineGrid[r][c] = countMines(r, c);
            
            updateMineCount();
        }
        
        function countMines(r, c) {
            let count = 0;
            for (let dr = -1; dr <= 1; dr++)
                for (let dc = -1; dc <= 1; dc++)
                    if (r+dr >= 0 && r+dr < MINE_ROWS && c+dc >= 0 && c+dc < MINE_COLS)
                        if (mineGrid[r+dr][c+dc] === -1) count++;
            return count;
        }
        
        function clickMine(r, c) {
            if (mineGameOver || mineRevealed[r][c] || mineFlags[r][c]) return;
            revealMine(r, c);
            if (mineGrid[r][c] === -1) { mineGameOver = true; showNotification('üí• BOOM! Game Over!'); }
            else if (checkWin()) showNotification('üéâ You Win! Horse-level concentration achieved!');
        }
        
        function revealMine(r, c) {
            if (r < 0 || r >= MINE_ROWS || c < 0 || c >= MINE_COLS) return;
            if (mineRevealed[r][c] || mineFlags[r][c]) return;
            mineRevealed[r][c] = true;
            
            const cells = document.querySelectorAll('.mine-cell');
            const cell = cells[r * MINE_COLS + c];
            cell.classList.add('revealed');
            
            if (mineGrid[r][c] === -1) {
                cell.classList.add('mine'); cell.textContent = 'üí£';
            } else if (mineGrid[r][c] > 0) {
                cell.textContent = mineGrid[r][c];
                cell.classList.add('num-' + mineGrid[r][c]);
            } else {
                for (let dr = -1; dr <= 1; dr++)
                    for (let dc = -1; dc <= 1; dc++)
                        revealMine(r + dr, c + dc);
            }
        }
        
        function flagMine(r, c) {
            if (mineGameOver || mineRevealed[r][c]) return;
            mineFlags[r][c] = !mineFlags[r][c];
            const cells = document.querySelectorAll('.mine-cell');
            cells[r * MINE_COLS + c].classList.toggle('flagged');
            updateMineCount();
        }
        
        function updateMineCount() {
            let flags = 0;
            for (let r = 0; r < MINE_ROWS; r++)
                for (let c = 0; c < MINE_COLS; c++)
                    if (mineFlags[r][c]) flags++;
            document.getElementById('mineCount').textContent = String(MINE_TOTAL - flags).padStart(3, '0');
        }
        
        function checkWin() {
            for (let r = 0; r < MINE_ROWS; r++)
                for (let c = 0; c < MINE_COLS; c++)
                    if (mineGrid[r][c] !== -1 && !mineRevealed[r][c]) return false;
            return true;
        }

        // Recycle Bin
        function emptyRecycle() {
            document.querySelector('#recycle .explorer-content').innerHTML = 
                '<div style="text-align:center;padding:40px"><div style="font-size:48px">üóëÔ∏è</div><p>Recycle Bin is empty.</p><p style="font-size:11px;color:gray">Your guilt has been deleted.</p></div>';
            showNotification('üóëÔ∏è Recycle Bin emptied successfully!');
        }

        // Notification
        function showNotification(text) {
            const n = document.getElementById('notification');
            document.getElementById('notifText').textContent = text;
            n.classList.add('show');
            setTimeout(() => n.classList.remove('show'), 3000);
        }

        // First time visitor check - NEW FLOW
        const hasVisited = localStorage.getItem('horseos_visited');
        let tutorialMode = false;
        
        if (!hasVisited) {
            // FIRST TIME EXPERIENCE
            tutorialMode = true;
            
            setTimeout(() => {
                // Show welcome popup with longer duration
                document.getElementById('firstTimePopup').innerHTML = `
                    <div class="leave-emoji">üêé</div>
                    <div class="leave-text">Welcome to HorseOS!</div>
                    <p style="margin:10px 0;font-size:12px">Your journey to digital wellness begins...</p>
                    <button onclick="startTutorial()" style="margin-top:10px">Click to Continue üëâ</button>
                `;
                document.getElementById('firstTimePopup').classList.add('show');
                
                // Enable tutorial blocker (prevents clicking desktop)
                document.getElementById('tutorialBlocker').classList.add('active');
                
                // Block all desktop icon clicks during tutorial
                document.querySelectorAll('.desktop-icon').forEach(icon => {
                    icon.dataset.originalOnclick = icon.onclick;
                    icon.onclick = function(e) {
                        if (tutorialMode) {
                            e.preventDefault();
                            e.stopPropagation();
                            // Wiggle the README icon
                            wiggleReadme();
                            return false;
                        }
                    };
                });
                
            }, 1000);
            
        } else {
            // Returning visitor - normal flow
            setTimeout(() => {
                openHorse();
                showNotification('üê¥ Welcome back! Time to contemplate.');
            }, 1500);
        }
        
        function startTutorial() {
            // Close welcome popup
            document.getElementById('firstTimePopup').classList.remove('show');
            
            // Show README notification pointing to it
            const readmeIcon = document.querySelector('.desktop-icon[onclick*="welcome"]');
            if (readmeIcon) {
                readmeIcon.classList.add('readme-wiggle');
                document.getElementById('readmeNotification').classList.add('show');
                
                // Position notification near README
                const rect = readmeIcon.getBoundingClientRect();
                document.getElementById('readmeNotification').style.top = (rect.top + 20) + 'px';
                document.getElementById('readmeNotification').style.left = (rect.right + 10) + 'px';
            }
            
            // After 8 seconds, auto-open Horse Moment (even if they didn't click README)
            setTimeout(() => {
                endTutorial();
                openHorse();
                localStorage.setItem('horseos_visited', 'true');
            }, 3000);
        }
        
        function wiggleReadme() {
            const readmeIcon = document.querySelector('.desktop-icon[onclick*="welcome"]');
            if (readmeIcon) {
                readmeIcon.classList.remove('readme-wiggle');
                void readmeIcon.offsetWidth; // Force reflow
                readmeIcon.classList.add('readme-wiggle');
            }
        }
        
        function endTutorial() {
            tutorialMode = false;
            document.getElementById('tutorialBlocker').classList.remove('active');
            document.getElementById('readmeNotification').classList.remove('show');
            
            // Remove wiggle from README
            const readmeIcon = document.querySelector('.desktop-icon[onclick*="welcome"]');
            if (readmeIcon) {
                readmeIcon.classList.remove('readme-wiggle');
            }
            
            // Restore original onclick handlers
            document.querySelectorAll('.desktop-icon').forEach(icon => {
                if (icon.dataset.originalOnclick) {
                    // Restore by re-setting the onclick from the HTML attribute
                    const onclickStr = icon.getAttribute('onclick');
                    if (onclickStr) {
                        icon.onclick = new Function('event', onclickStr);
                    }
                }
            });
        }
        
        // Override welcome window open to end tutorial
        const originalOpenWindow = openWindow;
        openWindow = function(id) {
            if (id === 'welcome' && tutorialMode) {
                endTutorial();
                // Clear the 8-second timeout since they clicked README
                // (We can't actually clear it, but tutorialMode prevents it from doing harm)
            }
            originalOpenWindow(id);
        };

        // Horse Blocker - prevent clicking other things
        function enableHorseBlocker() {
            document.getElementById('horseBlocker').classList.add('active');
        }
        
        function disableHorseBlocker() {
            document.getElementById('horseBlocker').classList.remove('active');
        }
        
        // Mouse leave detection - more reliable
        const leaveMessages = [
            "Where do you think you're going?",
            "The horse sees you trying to leave.",
            "Contemplation is not optional.",
            "Running away from your problems?",
            "The horse is disappointed in you.",
            "Get back here and contemplate!",
            "You cannot escape the horse.",
            "The horse knows you're avoiding this."
        ];
        
        let leavePopupShown = false;
        let horseTimerPaused = false;
        let pausedTimeRemaining = 0;
        
        // Use mouseout on documentElement for better detection
        document.documentElement.addEventListener('mouseleave', (e) => {
            console.log('Mouse leave detected', e.clientY, e.clientX);
            if (leavePopupShown) return;
            // Check if mouse left the viewport
            if (e.relatedTarget === null || e.clientY <= 0 || e.clientY >= window.innerHeight) {
                leavePopupShown = true;
                const randomMsg = leaveMessages[Math.floor(Math.random() * leaveMessages.length)];
                document.getElementById('leaveText').textContent = randomMsg;
                document.getElementById('horseLeavePopup').classList.add('show');
                
                // Pause the timer if running
                if (horseRunning && horseInterval) {
                    clearInterval(horseInterval);
                    horseTimerPaused = true;
                    pausedTimeRemaining = horseTime;
                    console.log('Timer paused at:', horseTime);
                }
            }
        });
        
        // Also detect when window loses focus
        window.addEventListener('blur', () => {
            console.log('Window lost focus');
            if (horseRunning && !leavePopupShown) {
                leavePopupShown = true;
                const randomMsg = leaveMessages[Math.floor(Math.random() * leaveMessages.length)];
                document.getElementById('leaveText').textContent = randomMsg;
                document.getElementById('horseLeavePopup').classList.add('show');
                
                if (horseInterval) {
                    clearInterval(horseInterval);
                    horseTimerPaused = true;
                    pausedTimeRemaining = horseTime;
                }
            }
        });
        
        function dismissLeavePopup() {
            document.getElementById('horseLeavePopup').classList.remove('show');
            leavePopupShown = false;
            
            // Resume timer if it was running
            if (horseRunning && horseTimerPaused && pausedTimeRemaining > 0) {
                horseTimerPaused = false;
                horseTime = pausedTimeRemaining;
                console.log('Timer resuming at:', horseTime);
                
                horseInterval = setInterval(() => {
                    horseTime--;
                    document.getElementById('horseTimer').textContent = horseTime;
                    
                    if (horseTime <= 0) {
                        clearInterval(horseInterval);
                        document.getElementById('horseTimer').innerHTML = '‚úì DONE';
                        document.getElementById('horseTimer').classList.add('complete');
                        document.getElementById('horseBtn').disabled = false;
                        document.getElementById('horseBtn').textContent = 'Return to Desktop';
                        document.getElementById('horseBtn').onclick = finishHorse;
                        showNotification('üéâ Contemplation complete! You are now more horse.');
                    }
                }, 1000);
            }
        }
        
        // Override openHorse to enable blocker
        const originalOpenHorse = openHorse;
        openHorse = function() {
            originalOpenHorse();
            enableHorseBlocker();
        };
        
        // Override finishHorse to disable blocker
        const originalFinishHorse = finishHorse;
        finishHorse = function() {
            originalFinishHorse();
            disableHorseBlocker();
        };

        // Scheduler Functions
        let horseDuration = 60;
        let autoInterval = 0;
        let autoHorseTimer = null;
        
        const horsePrompts = {
            standard: [
                "What would you do if you were a horse with WiFi?",
                "Reflect on your last email. Was it necessary?",
                "The horse judges your browser tabs. Explain yourself.",
                "If horses could code, what would they build?",
                "Contemplate the last time you touched grass."
            ],
            existential: [
                "Why do horses exist? Why do YOU exist?",
                "Contemplate the void. The horse contemplates with you.",
                "In 100 years, will anyone remember your Slack messages?",
                "The horse knows all your passwords. Reflect.",
                "What is the meaning of neigh?"
            ],
            corporate: [
                "Please contemplate your Q3 performance goals.",
                "The horse requests a TPS report on your thoughts.",
                "Let's circle back to your existential dread.",
                "Synergize your mindfulness with horse energy.",
                "Schedule a 1:1 with yourself. The horse will attend."
            ],
            zen: [
                "Be the grass the horse grazes upon.",
                "The neigh that can be spoken is not the eternal neigh.",
                "You are the horse. The horse is you. Neigh.",
                "Empty your mind like an empty stable.",
                "The journey of a thousand miles begins with one hoof."
            ],
            judgmental: [
                "The horse saw what you just did. Explain.",
                "Your posture is disappointing to the horse.",
                "That email you drafted but didn't send? The horse knows.",
                "The horse expected better from you.",
                "Your screen time embarrasses the entire equine community."
            ]
        };
        
        function updateDuration() {
            horseDuration = parseInt(document.getElementById('durationSelect').value);
            document.getElementById('durationDisplay').textContent = horseDuration + ' seconds';
        }
        
        function updateInterval() {
            autoInterval = parseInt(document.getElementById('intervalSelect').value);
            const display = autoInterval === 0 ? 'Manual' : 'Every ' + autoInterval + ' minutes';
            document.getElementById('intervalDisplay').textContent = display;
        }
        
        function saveSchedule() {
            const style = document.getElementById('styleSelect').value;
            
            // Clear existing auto timer
            if (autoHorseTimer) {
                clearInterval(autoHorseTimer);
                autoHorseTimer = null;
            }
            
            // Set up auto-horse if enabled
            if (autoInterval > 0) {
                autoHorseTimer = setInterval(() => {
                    if (!horseRunning) {
                        openHorse();
                        showNotification('üê¥ Scheduled Horse Moment! Time to contemplate.');
                    }
                }, autoInterval * 60 * 1000);
                document.getElementById('autoStatus').textContent = 'ON';
                document.getElementById('autoStatus').style.color = 'green';
            } else {
                document.getElementById('autoStatus').textContent = 'OFF';
                document.getElementById('autoStatus').style.color = 'red';
            }
            
            // Show confirmation
            const msg = document.getElementById('scheduleMsg');
            msg.textContent = '‚úÖ Settings saved! The horse is pleased.';
            setTimeout(() => msg.textContent = '', 3000);
            
            showNotification('üê¥ Schedule updated! Duration: ' + horseDuration + 's');
        }
        
        function testHorseNow() {
            closeWindow('scheduler');
            setTimeout(() => {
                openHorse();
                showNotification('üê¥ Test Horse Moment activated!');
            }, 300);
        }
        
        // Override startHorse to use custom duration
        const originalStartHorse = startHorse;
        startHorse = function() {
            if (horseRunning) return;
            horseRunning = true;
            horseTime = horseDuration;
            
            const btn = document.getElementById('horseBtn');
            btn.disabled = true;
            btn.textContent = 'Contemplating...';
            
            // Get random prompt based on style
            const style = document.getElementById('styleSelect')?.value || 'standard';
            const prompts = horsePrompts[style] || horsePrompts.standard;
            const randomPrompt = prompts[Math.floor(Math.random() * prompts.length)];
            
            // Update prompt display if it exists
            const promptEl = document.querySelector('.horse-message p:first-child');
            if (promptEl) {
                promptEl.innerHTML = '<strong>' + randomPrompt + '</strong>';
            }
            
            document.getElementById('horseProgress').style.width = '100%';
            document.getElementById('horseProgress').style.transition = 'width ' + horseDuration + 's linear';
            
            horseInterval = setInterval(() => {
                horseTime--;
                document.getElementById('horseTimer').textContent = horseTime;
                
                if (horseTime <= 0) {
                    clearInterval(horseInterval);
                    document.getElementById('horseTimer').innerHTML = '‚úì DONE';
                    document.getElementById('horseTimer').classList.add('complete');
                    btn.disabled = false;
                    btn.textContent = 'Return to Desktop';
                    btn.onclick = finishHorse;
                    showNotification('üéâ Contemplation complete! You are now more horse.');
                }
            }, 1000);
        };

        console.log('üê¥ HorseOS v2.0 - Super Retro Edition loaded!');
        console.log('Contemplation is mandatory.');
        console.log('Type openWindow("welcome") to read the manual.');
    </script>
</body>
</html>